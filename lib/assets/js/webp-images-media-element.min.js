!function(e){var a,t={togglePreloader:function(a){e(a).toggle()},regenerateImage:function(a){a.preventDefault(),e(".webp-images-error").remove(),t.togglePreloader("img.preloader.webp-images");var r={action:"regenerate_webp_images",_wpnonce:e("#generate_webp_image").val(),_referer:e('input[name="_wp_http_referer"]').val(),attachment_id:e(this).data("attachment")};jQuery.post(ajaxurl,r,function(a){if(t.togglePreloader("img.preloader.webp-images"),a.success){var n='<th scope="row" class="label"><label for="attachments-'+r.attachment_id+'-webp_image_url"><span class="alignleft">WebP URL</span><br class="clear"></label></th><td class="field"><label for="attachments-'+r.attachment_id+'-webp_image_url"><input type="text" readonly="readonly" class="widefat" id="attachments-'+r.attachment_id+'-webp_image_url" name="attachments['+r.attachment_id+'][webp_image_url]" value="'+a.data.webpImageURL+'"></label></td>';e(".compat-field-webp_image_url").html(n)}else e(".webp-images-url-error").closest(".field").append('<p class="webp-images-error">'+webpMediaElementData.errorResponse+"</p>")})},bulkRegenerateImages:function(r){"regen_webp_images"===e("#bulk-action-selector-top").val()&&r.preventDefault(),a=e('input[name="media[]"]:checked').map(function(){return e(this).val()}),t.listTableBulkActionRegenImage(0)},listTableBulkActionRegenImage:function(r){var n=a[r],l=e("img.preloader.generate-webp-"+n).clone();e("img.preloader.generate-webp-"+n).closest("td.webp_images").html(l),t.togglePreloader("img.preloader.generate-webp-"+n),e("#cb-select-"+n).click();var o={action:"regenerate_webp_images",return:"compression_stats",_wpnonce:e('a[data-attachment="'+n+'"]').closest("#generate_webp_image_"+n).val(),_referer:e('a[data-attachment="'+n+'"]').closest('input[name="_wp_http_referer"]').val(),attachment_id:n};jQuery.post(ajaxurl,o,function(l){t.togglePreloader("img.preloader.generate-webp-"+n);var o=l.success?l.data.compressionResults:"Error";e("img.preloader.generate-webp-"+n).after(o),r+1!==a.length&&t.listTableBulkActionRegenImage(r+1)})},listTableButtonRegenerateImage:function(a){a.preventDefault();var r=e(this).data("attachment"),n=e("img.preloader.generate-webp-"+r).clone();e("img.preloader.generate-webp-"+r).closest("td.webp_images").html(n),t.togglePreloader("img.preloader.generate-webp-"+r);var l={action:"regenerate_webp_images",return:"compression_stats",_wpnonce:e(this).closest("#generate_webp_image_"+r).val(),_referer:e(this).closest('input[name="_wp_http_referer"]').val(),attachment_id:r};jQuery.post(ajaxurl,l,function(a){t.togglePreloader("img.preloader.generate-webp-"+r);var n=a.success?a.data.compressionResults:"Error";e("img.preloader.generate-webp-"+r).after(n)})}};e(document).on("click",".js-generate-webp",t.regenerateImage),e(document).on("click",".js-generate-webp-table",t.listTableButtonRegenerateImage),e(document).on("click",".js-webp-regen-image-link",t.listTableButtonRegenerateImage),e(document).on("submit","#posts-filter",t.bulkRegenerateImages)}(jQuery);