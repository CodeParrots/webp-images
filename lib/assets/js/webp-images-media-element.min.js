!function(e){var t,a={togglePreloader:function(t){e(t).toggle()},regenerateImage:function(t){t.preventDefault(),e(".webp-images-error").remove(),a.togglePreloader("img.preloader.webp-images");var s={action:"regenerate_webp_images",_wpnonce:e("#generate_webp_image").val(),_referer:e('input[name="_wp_http_referer"]').val(),attachment_id:e(this).data("attachment")};jQuery.post(ajaxurl,s,function(t){if(a.togglePreloader("img.preloader.webp-images"),t.success){var r='<th scope="row" class="label"><label for="attachments-'+s.attachment_id+'-webp_image_url"><span class="alignleft">WebP URL</span><br class="clear"></label></th><td class="field"><label for="attachments-'+s.attachment_id+'-webp_image_url"><input type="text" readonly="readonly" class="widefat" id="attachments-'+s.attachment_id+'-webp_image_url" name="attachments['+s.attachment_id+'][webp_image_url]" value="'+t.data.webpImageURL+'"></label></td>';e(".compat-field-webp_image_url").html(r)}else e(".webp-images-url-error").closest(".field").append('<p class="webp-images-error">'+webpMediaElementData.errorResponse+"</p>")})},bulkRegenerateImages:function(s){"regen_webp_images"===e("#bulk-action-selector-top").val()&&s.preventDefault(),t=e('input[name="media[]"]:checked').map(function(){return e(this).val()}),a.listTableBulkActionRegenImage(0)},listTableBulkActionRegenImage:function(s){var r=t[s];e(".webp-image-results."+r).html(webpMediaElementData.preloader),e("#cb-select-"+r).prop("checked",!1);var n={action:"regenerate_webp_images",return:"compression_stats",_wpnonce:e('a[data-attachment="'+r+'"]').closest("#generate_webp_image_"+r).val(),_referer:e('a[data-attachment="'+r+'"]').closest('input[name="_wp_http_referer"]').val(),attachment_id:r};jQuery.post(ajaxurl,n,function(n){var i=n.success?n.data.compressionResults:n.data.message;e(".webp-image-results."+r).next().remove(),e(".webp-image-results."+r).html(i),s+1!==t.length&&a.listTableBulkActionRegenImage(s+1)})},listTableButtonRegenerateImage:function(t){t.preventDefault();var a=e(this).data("attachment"),s=e(this).hasClass("button-secondary"),r=e(this).closest(".row-actions");s&&e(this).remove(),e(".webp-image-results."+a).html(webpMediaElementData.preloader);var n={action:"regenerate_webp_images",return:"compression_stats",_wpnonce:e(this).closest("#generate_webp_image_"+a).val(),_referer:e(this).closest('input[name="_wp_http_referer"]').val(),attachment_id:a};jQuery.post(ajaxurl,n,function(t){var s=t.success?t.data.compressionResults:"Error";r.remove(),e(".webp-image-results."+a).replaceWith(s)})},toggleCompressionStatVisibility:function(t){t.preventDefault();var a=e(this).data("attachment"),s=e(this).find("span.dashicons").attr("class"),r=e(this).data("icon");s=s.replace("dashicons ","").replace("dashicons-",""),e(this).data("icon",s),e(this).find("span.dashicons").attr("class","dashicons dashicons-"+r),e(".compression-stats."+a).stop().slideToggle()},regenerateWebpSize:function(t){t.preventDefault();var a=e(this).data("attachment"),s=e(this).data("size"),r=e(this).closest("li"),n=e(this).closest("strong").clone();r.html(webpMediaElementData.preloader);var i={action:"regenerate_webp_image_size",return:"compression_stats",attachment_id:a,size:s};jQuery.post(ajaxurl,i,function(e){var t=e.success?e.data.compressionResults:e.data.message;r.html("<br />"+t),r.prepend(n)})}};e(document).on("click",".js-generate-webp",a.regenerateImage),e(document).on("click",".js-webp-regen-image-link",a.listTableButtonRegenerateImage),e(document).on("click",".js-toggle-image-size-stats",a.toggleCompressionStatVisibility),e(document).on("click",".js-regenerate-webp-size",a.regenerateWebpSize),e(document).on("submit","#posts-filter",a.bulkRegenerateImages)}(jQuery);